# Migration `20200621204450-add-excerpt-field--fix-field-name-casing--fix-image`

This migration has been generated by Robin MacPherson at 6/21/2020, 8:44:50 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Image" DROP CONSTRAINT IF EXiSTS "Image_postId_ImageToPost_fkey",
DROP COLUMN "postId_ImageToPost",
DROP COLUMN "postId",
ADD COLUMN "postId" integer   ;

ALTER TABLE "public"."Post" ADD COLUMN "excerpt" text  NOT NULL ,
ALTER COLUMN "status" SET DEFAULT 'DRAFT';

ALTER TABLE "public"."User" ALTER COLUMN "userRole" SET DEFAULT 'FREE_USER';

ALTER TABLE "public"."Image" ADD FOREIGN KEY ("postId")REFERENCES "public"."Post"("id") ON DELETE SET NULL  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200620202031-add-user-profile-image..20200621204450-add-excerpt-field--fix-field-name-casing--fix-image
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 generator prisma_client {
   provider = "prisma-client-js"
@@ -24,14 +24,14 @@
   languagesNative   LanguageNative[]
   languagesLearning LanguageLearning[]
   createdAt         DateTime           @default(now())
   updatedAt         DateTime           @updatedAt
-  UserInterests     UserInterests[]
-  PostLike          PostLike[]
-  CommentLike       CommentLike[]
-  PageView          PageView[]
+  userInterests     UserInterests[]
+  postLike          PostLike[]
+  commentLike       CommentLike[]
+  pageView          PageView[]
   profileImage      String?
-  Comment           Comment[]
+  comment           Comment[]
 }
 model Auth {
   id               Int       @default(autoincrement()) @id
@@ -75,8 +75,9 @@
 model Post {
   id         Int          @default(autoincrement()) @id
   title      String
   body       String
+  excerpt    String
   status     PostStatus   @default(DRAFT)
   images     Image[]
   createdAt  DateTime     @default(now())
   updatedAt  DateTime     @updatedAt
@@ -89,9 +90,9 @@
   languageId Int
   longitude  Float?
   latitude   Float?
   threads    Thread[]
-  PostTopics PostTopics[]
+  postTopics PostTopics[]
 }
 model Language {
   id            Int                @default(autoincrement()) @id
@@ -114,13 +115,13 @@
 model Topic {
   id            Int             @default(autoincrement()) @id
   name          String
   posts         Post[]          @relation(references: [id])
-  User          User?           @relation(fields: [userId], references: [id])
+  user          User?           @relation(fields: [userId], references: [id])
   userId        Int?
-  UserInterests UserInterests[]
-  PostTopics    PostTopics[]
-  Prompt        Prompt[]
+  userInterests UserInterests[]
+  postTopics    PostTopics[]
+  prompt        Prompt[]
 }
 model UserInterests {
   id        Int      @default(autoincrement()) @id
@@ -183,15 +184,14 @@
   comments           Comment[]
 }
 model Image {
-  id                 Int       @default(autoincrement()) @id
-  smallSize          String
-  largeSize          String
-  postId             String?
-  imageRole          ImageRole
-  Post               Post?     @relation(fields: [postId_ImageToPost], references: [id])
-  postId_ImageToPost Int?
+  id        Int       @default(autoincrement()) @id
+  smallSize String
+  largeSize String
+  imageRole ImageRole
+  post      Post?     @relation(fields: [postId], references: [id])
+  postId    Int?
 }
 model Prompt {
   id      Int    @default(autoincrement()) @id
```

# Migration `20200813092954-add-post-comment`

This migration has been generated by Robin MacPherson at 8/13/2020, 9:29:54 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Post" ALTER COLUMN "status" SET DEFAULT 'DRAFT';

ALTER TABLE "public"."PostCommentLike" DROP CONSTRAINT IF EXiSTS "PostCommentLike_commentId_fkey",
DROP COLUMN "commentId";

ALTER TABLE "public"."User" ALTER COLUMN "userRole" SET DEFAULT 'FREE_USER';
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200805064655-add-published-at-to-posts..20200813092954-add-post-comment
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 generator prisma_client {
   provider = "prisma-client-js"
@@ -30,8 +30,10 @@
   commentLike       CommentLike[]
   pageView          PageView[]
   profileImage      String?
   comment           Comment[]
+  PostCommentLike   PostCommentLike[]
+  PostComment       PostComment[]
 }
 model Auth {
   id               Int       @default(autoincrement()) @id
@@ -72,29 +74,30 @@
   authorId Int
 }
 model Post {
-  id          Int         @default(autoincrement()) @id
-  title       String
-  body        String
-  bodySrc     String      @default("")
-  excerpt     String
-  status      PostStatus  @default(DRAFT)
-  images      Image[]
-  createdAt   DateTime    @default(now())
-  updatedAt   DateTime    @updatedAt
-  publishedAt DateTime?
-  author      User        @relation(fields: [authorId], references: [id])
-  authorId    Int
-  readTime    Int         @default(1)
-  likes       PostLike[]
-  topic       Topic[]     @relation(references: [id])
-  language    Language    @relation(fields: [languageId], references: [id])
-  languageId  Int
-  longitude   Float?
-  latitude    Float?
-  threads     Thread[]
-  postTopics  PostTopic[]
+  id           Int           @default(autoincrement()) @id
+  title        String
+  body         String
+  bodySrc      String        @default("")
+  excerpt      String
+  status       PostStatus    @default(DRAFT)
+  images       Image[]
+  createdAt    DateTime      @default(now())
+  updatedAt    DateTime      @updatedAt
+  publishedAt  DateTime?
+  author       User          @relation(fields: [authorId], references: [id])
+  authorId     Int
+  readTime     Int           @default(1)
+  likes        PostLike[]
+  topic        Topic[]       @relation(references: [id])
+  language     Language      @relation(fields: [languageId], references: [id])
+  languageId   Int
+  longitude    Float?
+  latitude     Float?
+  threads      Thread[]
+  postTopics   PostTopic[]
+  postComments PostComment[]
 }
 model Language {
   id            Int                @default(autoincrement()) @id
@@ -163,8 +166,17 @@
   comment   Comment  @relation(fields: [commentId], references: [id])
   commentId Int
 }
+model PostCommentLike {
+  id            Int          @default(autoincrement()) @id
+  createdAt     DateTime     @default(now())
+  author        User         @relation(fields: [userId], references: [id])
+  userId        Int
+  PostComment   PostComment? @relation(fields: [postCommentId], references: [id])
+  postCommentId Int?
+}
+
 model Comment {
   id        Int           @default(autoincrement()) @id
   createdAt DateTime      @default(now())
   updatedAt DateTime      @updatedAt
@@ -175,8 +187,20 @@
   threadId  Int
   likes     CommentLike[]
 }
+model PostComment {
+  id        Int               @default(autoincrement()) @id
+  createdAt DateTime          @default(now())
+  updatedAt DateTime          @updatedAt
+  body      String
+  author    User              @relation(fields: [authorId], references: [id])
+  authorId  Int
+  post      Post              @relation(fields: [postId], references: [id])
+  postId    Int
+  likes     PostCommentLike[]
+}
+
 model Thread {
   id                 Int       @default(autoincrement()) @id
   startIndex         Int
   endIndex           Int
```


